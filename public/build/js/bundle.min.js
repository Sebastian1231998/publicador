function eventListeners(){crearGaleria()}function crearGaleria(){const e=document.querySelector(".galeria-imagenes-profile");for(let t=1;t<=6;t++){const o=document.createElement("LI");o.style.textAlign="center",o.style.listStyle="none";const n=document.createElement("IMG");n.style.height="142px",n.style.padding="1rem",n.style.cursor="pointer",n.classList.add("z-depth-3"),n.src=`/build/img/perfil_prueba_${t}.webp`,n.dataset.imagenId=t,o.appendChild(n),e.appendChild(o),o.onclick=crearImagen}}function crearImagen(e){console.log("diste click en imagen: "+e.target);const t=parseInt(e.target.dataset.imagenId),o=document.createElement("DIV"),n=document.createElement("DIV");o.style.position="fixed",o.style.width="100%",o.style.height="100vh",o.style.top="0",o.style.backgroundColor="rgb(41 41 41 / 50%)",o.style.zIndex="1",n.classList.add("overlay"),n.style.position="fixed",n.style.width="31%",n.style.height="67%",n.style.top="25rem",n.style.right="56rem",n.style.backgroundColor="rgba(0,0,0, .5s)",n.style.display="grid",n.style.placeItems="center",n.style.overflow="hidden",o.appendChild(n);const l=document.createElement("IMG");l.src=`/build/img/perfil_prueba_${t}.webp`,l.classList.add("imagen-grande"),cantidad=document.querySelectorAll(".overlay").length,l.style.maxWidth="100%",n.appendChild(l);const i=document.querySelector("body");i.appendChild(o),i.classList.add("fijar-body"),n.onclick=function(){o.remove(),console.log(cantidad),i.classList.remove("fijar-body")}}document.addEventListener("DOMContentLoaded",(function(){eventListeners()}));let id_usuarioRecibe,nombre,apellido,foto_perfi_recibe,foto_perfi_envia,valida_message,instanceCategoria,idUsuarioComment,idPublicacionComment,validador=0,validateLectureMessage=!1,val_notify=1,obj_temp=[],uCollection=!1,params=new URLSearchParams(location.search),id=params.get("id");function eventListenersMessages(){mensajes(),leeInput()}function mensajes(){let e=document.querySelectorAll(".user-message");e.forEach(t=>{t.addEventListener("click",(function(o){let n;n="P"==o.target.tagName?o.target.parentElement.parentElement:"DIV"==o.target.tagName?o.target.parentElement:o.target,id_usuarioRecibe=t.getAttribute("user-id"),nombre=t.getAttribute("user-nombre"),apellido=t.getAttribute("user-apellido"),foto_perfi_recibe=t.getAttribute("foto-perfil");let l=document.querySelector(".user-contact .avatar a"),i=document.querySelector(".user-contact .avatar p");l.setAttribute("href","/user/profile?id="+id_usuarioRecibe),""===foto_perfi_recibe&&(foto_perfi_recibe="avatar_null.png"),l.children[0].setAttribute("src","/imagenes/profile/"+foto_perfi_recibe),i.textContent=` ${nombre} ${apellido} `,n.style.backgroundColor="aliceblue",n.classList.add("aliceblue"),consultaMessages(foto_perfi_recibe),validador++,2==validador&&e.forEach(e=>{e.classList.contains("aliceblue")&&(e.classList.remove("aliceblue"),e.style.backgroundColor="white",n.style.backgroundColor="aliceblue",n.classList.add("aliceblue"),validador=1)})}))})}function consultaMessages(e){let t=new XMLHttpRequest,o=document.querySelector(".input-message").getAttribute("data-userId-send");t.open("GET",`/models/messages?id=${o}&recieve=${id_usuarioRecibe}`,!0),t.onload=function(){if(200==this.status){let e,o=JSON.parse(t.responseText).resultado,n=JSON.parse(t.responseText).usuario_envia_foto,l=JSON.parse(t.responseText).usuario_recibe_foto,i=document.querySelector(".body-message-content");if(uCollection=document.querySelector(".message-user-collection"),document.querySelectorAll(".differente")||0==o.lenght){document.querySelectorAll(".differente").forEach(e=>{e.remove()})}document.querySelector(".differente-li")&&document.querySelector(".differente-li").remove();let a=document.querySelector(".input-message").getAttribute("data-userId-send"),r=0;o.forEach(t=>{let s=document.createElement("LI");s.classList.add("collection-item","differente","avatar"),r++,r==o.length&&s.setAttribute("id","ultimateMessage"),s.style.padding="0 1rem",s.style.height="auto",s.style.marginBottom="5rem";let c=document.createElement("DIV");c.style.display="flex",c.classList.add(".avatar"),c.style.textAlign="-webkit-center",c.style.padding="1rem 1rem",c.style.textAlign="flex",c.style.alignItems="center";let d=document.createElement("DIV");d.style.display="flex",d.style.flexDirection="column-reverse",d.style.gap="1rem";let u=document.createElement("SPAN");u.style.fontSize=".9rem",u.textContent=""+t.fecha_creacion;let m=document.createElement("A");e=a!=t.idUsuarioEnvia&&""==l?"avatar_null.png":a!=t.idUsuarioEnvia?l:n;let p=document.createElement("IMG");p.setAttribute("src","/imagenes/profile/"+e),p.style.width="50px",p.style.borderRadius="10rem",p.style.height="50px";let g=document.createElement("P");g.style.fontSize="1.6rem",g.style.margin="2rem",g.textContent=t.contenido,m.appendChild(p),d.appendChild(u),d.appendChild(m),c.appendChild(d),c.appendChild(g),s.appendChild(c),uCollection.appendChild(s),i.appendChild(uCollection)})}document.querySelector("#ultimateMessage").scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})},t.send();let n=JSON.parse(localStorage.getItem("envios"));console.log(n),n.forEach(e=>{if(e.user_id_recibe==o&&e.profile_id==id_usuarioRecibe){let t=n.indexOf(e);if(console.log(t),-1!=t){n.splice(t,1),localStorage.setItem("envios",JSON.stringify(n));let e=new FormData;e.append("elimina_notificacion",3),deleteNotificationMessage(e)}}})}function deleteNotificationMessage(e){console.log("estoy aqui...");let t=new XMLHttpRequest;t.open("POST","/models/messages/updateNotification",!0),t.onload=function(){if(200==this.status){let e=JSON.parse(t.responseText);if("correcto"==e.respuesta){document.querySelector(".texto-notificacion").textContent=e.notify}}},t.send(e)}function leeInput(){let e=document.querySelector(".input-message"),t=document.querySelector(".submitMensaje"),o="";e.addEventListener("input",(function(e){o=e.target.value})),t.addEventListener("click",(function(t){if(t.preventDefault(),null==id_usuarioRecibe)mensajeMessage("no estas enviando a ningun usuario el mensaje","error");else{""==o&&mensajeMessage("el mensaje esta vacio","error");let t=o,n=e.getAttribute("data-userId-send");foto_perfi_envia=e.getAttribute("foto-perfil-userActive");let l=!1,i=new Date;hour=i.getHours(),minutes=i.getMinutes(),seconds=i.getSeconds();let a=new FormData,r=JSON.parse(localStorage.getItem("envios"));if(null==r&&(r=[]),0==r.length)obj_temp=[...r,{enviados:val_notify,user_id_recibe:id_usuarioRecibe,profile_id:n}],localStorage.setItem("envios",JSON.stringify(obj_temp)),a.append("cantidad_enviado",1);else{for(let e=0;e<r.length;e++){if(console.log(r[e].user_id_recibe+"=="+id_usuarioRecibe),console.log(r[e].profile_id+"=="+n),r[e].user_id_recibe==id_usuarioRecibe&&r[e].profile_id==n){l=!0;break}l=!1}console.log(l),l?r.forEach((e,t)=>{if(e.user_id_recibe==id_usuarioRecibe&&e.profile_id==n&&(console.log(e.enviados+"con ID"+e.user_id_recibe),e.enviados>=1)){obj_temp={enviados:2,user_id_recibe:id_usuarioRecibe,profile_id:n};let t=r.indexOf(e);console.log(t),-1!=t&&r.splice(t,1,obj_temp),localStorage.setItem("envios",JSON.stringify(r)),a.append("cantidad_enviado",2)}}):(other=1,obj_temp=[...r,{enviados:other,user_id_recibe:id_usuarioRecibe,profile_id:n}],val_notify=1,localStorage.setItem("envios",JSON.stringify(obj_temp)),a.append("cantidad_enviado",1))}a.append("contenido",t),a.append("idUsuarioRecibe",id_usuarioRecibe),a.append("idUsuarioEnvia",n),a.append("fecha_creacion",i.getFullYear()+"-0"+(i.getMonth()+1)+"-0"+(i.getDate()+1)+" "+hour+":"+minutes+":"+seconds),e.value="",insertMessage(a),t=""}}))}function insertMessage(e){let t=new XMLHttpRequest;t.open("POST","/models/messages",!0),t.onload=function(){if(200==this.status){let e=JSON.parse(t.responseText);if(console.log(t.responseText),"correcto"==e.respuesta){let t=document.querySelector(".body-message-content"),o=document.querySelector(".message-user-collection");document.querySelector(".differente-body")&&document.querySelector(".differente-body").remove(),document.querySelector("#ultimateMessage")&&document.querySelector("#ultimateMessage").setAttribute("id",null);let n=document.createElement("LI");n.setAttribute("id","ultimateMessage"),n.classList.add("collection-item","avatar","differente-li"),n.style.padding="0 1rem",n.style.height="auto",n.style.marginBottom="5rem";let l=document.createElement("DIV");l.style.display="flex",l.classList.add(".avatar"),l.style.textAlign="-webkit-center",l.style.padding="1rem 1rem",l.style.textAlign="flex",l.style.alignItems="center";let i=document.createElement("DIV");i.style.display="flex",i.style.flexDirection="column-reverse",i.style.gap="1rem";let a=document.createElement("SPAN");a.style.fontSize=".9rem",a.textContent=""+e.fecha_creacion;let r=document.createElement("A");""===foto_perfi_envia&&(foto_perfi_envia="avatar_null.png");let s=document.createElement("IMG");s.setAttribute("src","/imagenes/profile/"+foto_perfi_envia),s.style.width="50px",s.style.borderRadius="10rem",s.style.height="50px";let c=document.createElement("P");c.style.fontSize="1.6rem",c.style.margin="2rem",c.textContent=e.contenido,r.appendChild(s),i.appendChild(a),i.appendChild(r),l.appendChild(i),l.appendChild(c),n.appendChild(l),o.appendChild(n),t.appendChild(o),document.querySelector("#ultimateMessage").scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}let o,n=document.querySelectorAll(".special-messages");for(let t=0;t<n.length;t++){if(n[t].getAttribute("user-id")==e.idUsuarioRecibe){valida_message=!0,o=n[t].childNodes;break}valida_message=!1}valida_message&&(o[1].childNodes[5].textContent=e.contenido)}},t.send(e)}function mensajeMessage(e,t){let o=document.querySelector(".campo-message");if(null==document.querySelector(".mensaje")){let n=document.createElement("div");n.classList.add("mensaje",t),n.style.width="100%",n.style.borderRadius="1rem%",n.style.paddin=".1rem 0",n.style.opacity="1",n.style.transition="opacity 2s ease%",n.style.backgroundColor="red",n.style.textAlign="center";let l=document.createElement("div");l.classList.add("contenido-mensaje"),l.innerHTML=`<p style="color:white">${e}</p>`,n.appendChild(l),o.appendChild(n),setTimeout(()=>{n.remove()},3e3)}}function cambiaFotoPerfil(){let e,t;document.querySelector(".imagen_perfil")&&(e=document.querySelector(".imagen_perfil")),e.addEventListener("click",(function(){var e=document.querySelectorAll(".modal");M.Modal.init(e)})),document.querySelector(".categoria-publicador")&&(t=document.querySelector(".categoria-publicador")),t.addEventListener("click",(function(){var e=document.querySelectorAll(".modal");M.Modal.init(e)}))}function eligeCategoria(){let e=document.querySelectorAll(".collection-item"),t=document.querySelector(".categoria-input"),o=document.querySelector("#categoriaModal");console.log(e),e.forEach(e=>{e.addEventListener("click",(function(n){let l=n.target.innerText.replace("send"," ");""==e.style.backgroundColor&&(e.style.backgroundColor="blue",e.ondblclick=function(n){if(console.log("doble click"),t.value=l.trim(),console.log("categoria:  "+t.value),o.style.display="none",document.querySelector(".modal-overlay")){document.querySelector(".modal-overlay").remove();let o=document.querySelector(".categoria-seleccionada");o.textContent=t.value,o.style.display="block",e.style.backgroundColor="white"}})}))})}document.addEventListener("DOMContentLoaded",(function(){eventListenersMessages()})),document.addEventListener("DOMContentLoaded",(function(){cambiaFotoPerfil(),eligeCategoria()}));let validate=!1;function modalLikeUser(){document.querySelectorAll(".you-like-href").forEach(e=>{e.addEventListener("click",(function(){var e=document.querySelectorAll(".modal");M.Modal.init(e)}))})}function likeUser(){document.querySelectorAll(".like-publicador").forEach(e=>{e.addEventListener("click",(function(t){let o=parseInt(e.getAttribute("user-id"),10),n=parseInt(e.getAttribute("id-publicaciones"),10),l=parseInt(e.getAttribute("validate-data"),10),i=parseInt(e.getAttribute("data-like"),10),a=e.getAttribute("validate-id");console.log("publicacion:"+n+"esta es su cantidad de likes:"+i),console.log(o),console.log(n),console.log(l);let r=new FormData;r.append("likes",i),r.append("usuarioId",o),r.append("id_publicaciones",n),r.append("local_like",l);let s=new XMLHttpRequest;s.open("POST","/homepage",!0),s.onload=function(){if(200==this.status){let t=JSON.parse(s.responseText);if(0==t.local_like){console.log(t),e.style.backgroundColor="white",document.querySelectorAll(".like-publicador").forEach(e=>{console.log(e.id_publicaciones+"=="+n),e.getAttribute("id-publicaciones")==n&&(e.parentElement.childNodes[3].innerText=`a ${t.count_likes} les gusta esta publicacion`)}),e.setAttribute("validate-data",t.local_like),e.setAttribute("data-like",t.count_likes),document.querySelector(`#likesModal${a} .modal-content`).childNodes.forEach(e=>{if(null==e.outerText||""==e.outerText)console.log("estan vacias:"+e.outerText);else{let o=e.outerText.replace("Ver perfil"," "),n=`${t.nombre} ${t.apellido}`;console.log(o.trim()),o.trim()==n.trim()&&(console.log("Estoy aqui"),e.remove())}})}else if(1==t.local_like&&(console.log("estas en 0"),console.log(t),t.like)){e.style.backgroundColor="red",document.querySelectorAll(".like-publicador").forEach(e=>{console.log(e.id_publicaciones+"=="+n),e.getAttribute("id-publicaciones")==n&&(t.count_likes-1==0?e.parentElement.childNodes[3].innerText="a ti te gusta":e.parentElement.childNodes[3].innerText=`a ti te gusta y a ${t.count_likes-1} personas mas les gusta esta publicacion`)}),e.setAttribute("validate-data",t.local_like),e.setAttribute("data-like",t.count_likes);let o=!0;if(o){let e=document.querySelector(`#likesModal${a} .modal-content`),n=document.createElement("LI");n.style.padding="1rem 1rem",n.style.height="8rem",n.style.listStyle="none",n.classList.add("collection-item","avatar");let l=document.createElement("DIV");l.style.textAlign="center",l.style.padding="1rem 1rem",l.style.display="flex",l.style.alignItems="center",l.style.justifyContent="space-between",l.classList.add("collection-item","avatar");let i=document.createElement("DIV");i.style.textAlign="center",i.style.padding="1rem 1rem",i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="space-between";let r=document.createElement("a");r.setAttribute("href","/user/profile/?id="+t.id);let s=document.createElement("IMG");s.setAttribute("src","/imagenes/profile/"+t.foto_perfil),s.style.width="50px",s.style.height="50px",s.style.borderRadius="10rem",r.appendChild(s);let c=document.createElement("P");c.style.fontSize="1.3rem",c.style.width="26rem",c.textContent=`${t.nombre} ${t.apellido}`,i.appendChild(r),i.appendChild(c);let d=document.createElement("a");d.setAttribute("href","/user/profile/?id="+t.id),d.style.padding="1rem 2rem",d.style.color="white",d.style.borderRadius="1rem",d.style.backgroundColor="#4c77ff",d.textContent="Ver perfil",l.appendChild(i),l.appendChild(d),n.appendChild(l),e.appendChild(n),o=!1}}}},s.send(r)}))})}function crearComments(){let e;document.querySelectorAll("#comentario").forEach(t=>{t.addEventListener("input",(function(t){e=t.target.value})),t.addEventListener("keydown",(function(o){if(13===o.keyCode){idUsuarioComment=t.getAttribute("user-id"),idPublicacionComment=t.getAttribute("id-publicaciones");let o=new FormData;o.append("descripcion_comentario",e),o.append("idUsuario",idUsuarioComment),o.append("idPublicacion",idPublicacionComment),o.append("accion","crearComentario"),insertComments(o,t)}}))})}function insertComments(e,t){console.log("comunicando");let o=new XMLHttpRequest;o.open("POST","/models/comments",!0),o.onload=function(){if(200==this.status){let e=JSON.parse(o.responseText),n=document.createElement("DIV");n.classList.add("campo-publicador","unique-create-comment"),n.style.backgroundColor="#dedcd8",n.style.width="auto",n.height="auto",n.style.borderRadius="5px",n.style.marginLeft="2rem",n.style.border="1px solid #dac5c5",n.style,margin="0px 2rem";let l=document.createElement("P");l.style.fontSize="1.2rem",l.style.padding=".5rem",l.textContent=e.descripcionComentario,n.appendChild(l);let i=t.parentElement.parentElement.parentElement.cloneNode(!0);i.children[1].children[1].children[0].value="",t.parentElement.parentElement.appendChild(n),t.parentElement.parentElement.parentElement.parentElement.appendChild(i),t.parentElement.remove(),t.remove(),crearComments(),validate=!0}},o.send(e)}function consultaComments(){document.querySelectorAll(".consultaComment").forEach(e=>{e.addEventListener("click",(function(){let t=!1;idUsuarioComment=e.getAttribute("user-id"),idPublicacionComment=e.getAttribute("id-publicaciones"),console.log("ID usuari"+idUsuarioComment),console.log("ID publicacion"+idPublicacionComment),document.querySelectorAll(".body-comments").forEach(e=>{e.getAttribute("body-publicaciones")==idPublicacionComment&&("block"==e.style.display?(e.classList.add("animate__animated","animate__fadeOut"),setTimeout(()=>{e.style.display="none"},500),t=!1,queryComments(e,t)):(t=!0,queryComments(e,t),e.style.display="block",e.classList.add("animate__animated","animate__fadeIn"),e.classList.contains("animate__fadeOut")&&e.classList.remove("animate__fadeOut")))})}))})}function queryComments(e,t){let o=new XMLHttpRequest;o.open("GET","/models/comments?id_publicacion="+idPublicacionComment,!0),o.onload=function(){if(200==this.status){let n=JSON.parse(o.responseText);if(t)n.forEach(t=>{let o=document.createElement("LI");o.style.listStyle="none",o.classList.add("commentsPublication");let n=document.createElement("SPAN");n.style.fontSize="1rem",n.style.padding="1rem",n.textContent=`${t.nombre} ${t.apellido}`;let l,i=document.createElement("DIV");i.style.textAlign="-webkit-center",i.style.padding="1rem",i.style.display="flex",i.classList.add("avatar"),l=""==t.foto_perfil?"/build/img/avatar_null.png":"/imagenes/profile/"+t.foto_perfil;let a=document.createElement("IMG");a.setAttribute("src",l),a.style.width="70px",a.style.borderRadius="10rem",a.style.height="70px",a.style.marginRight="2rem";let r=document.createElement("DIV");r.classList.add("campo-publicador"),r.style.backgroundColor="#dedcd8",r.style.width="auto",r.height="auto",r.style.borderRadius="5px",r.style.border="1px solid #dac5c5",r.style,margin="0px 2rem";let s=document.createElement("P");s.style.fontSize="1.2rem",s.style.padding=".5rem",s.textContent=t.descripcion_comentario,r.appendChild(s),i.appendChild(a),i.appendChild(r),o.appendChild(n),o.appendChild(i),e.insertBefore(o,e.children[0])});else{let t=document.querySelectorAll(".commentsPublication"),o=e.children.length-2;validate&&(e.children[o].remove(),validate=!1),t.forEach(e=>{e.remove(),document.querySelector(".unique-create-comment")&&document.querySelector(".unique-create-comment").parentElement.remove()})}}},o.send()}function registroUser(){document.querySelector(".submit").addEventListener("click",(function(e){e.preventDefault();let t=document.querySelector("#nombre").value,o=document.querySelector("#apellido").value,n=document.querySelector("#fecha").value,l=document.querySelector("#password").value,i=document.querySelector("#email").value,a=document.querySelector(".genero").value,r=e.target.value;console.log(a),console.log("diste click en submit");if(""===t.trim()||""===o.trim()||""===n.trim()||""===l.trim()||""===i.trim()||""===a.trim())mensaje("todos los campos son obligatorios","error");else{console.log("pasa validacion");let s=new FormData,c=new Date;s.append("nombre",t),s.append("apellido",o),s.append("fecha_nacimiento",n),s.append("password",l),s.append("correo",i),s.append("genero",a),s.append("accion",r),s.append("fecha_creacion",c.getFullYear()+"-0"+(c.getMonth()+1)+"-0"+(c.getUTCDay()+1)),"registro"==e.target.value&&insertarBD(s)}}))}function insertarBD(e){console.log(...e);let t=new XMLHttpRequest;t.open("POST","models/usuario",!0),t.onload=function(){if(200==this.status){if(console.log(t.responseText),!t.responseText)return void mensaje("Hubo un error: puede ser que el correo ya este registrado","error");Swal.fire("Registrado!","Te vamos a llevar al login para que inicies sesión","success"),setTimeout(()=>{window.location.href="/login"},3e3)}},t.send(e)}function mensaje(e,t){let o=document.querySelector(".form-registro");if(null==document.querySelector(".mensaje")){let n=document.createElement("div");n.classList.add("mensaje",t),n.style.width="100%",n.style.borderRadius="1rem%",n.style.paddin=".1rem 0",n.style.opacity="1",n.style.transition="opacity 2s ease%",n.style.backgroundColor="red",n.style.textAlign="center";let l=document.createElement("div");l.classList.add("contenido-mensaje"),l.innerHTML=`<p style="color:white">${e}</p>`,n.appendChild(l),o.appendChild(n),setTimeout(()=>{n.remove()},3e3)}}document.addEventListener("DOMContentLoaded",(function(){likeUser(),modalLikeUser(),crearComments(),consultaComments()})),document.addEventListener("DOMContentLoaded",(function(){registroUser()}));
//# sourceMappingURL=bundle.js.map
